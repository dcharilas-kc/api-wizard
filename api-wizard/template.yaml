apiVersion: scaffolder.backstage.io/v1beta3
# https://backstage.io/docs/features/software-catalog/descriptor-format#kind-template
kind: Template
metadata:
  name: api-template
  title: REST API Template
  description: An template to create REST APIs
spec:
  owner: user:guest
  type: service

  parameters:
    - title: API Overview
      required:
        - name
        - version
      properties:
        name:
          title: Name
          type: string
          description: The name of your API
        description:
          title: Description
          type: string
          description: Describe your API
          ui:widget: textarea
          ui:autofocus: true
          ui:options:
            rows: 3
        version:
          title: Version
          type: number
          default: 1
    - title: API Owner
      required:
        - ownerName
        - ownerEmail
        - team
      properties:
        ownerName:
          title: Owner Name
          type: string
          description: The name of the person to contact regarding this API
        ownerEmail:
          title: Owner e-mail
          type: string
          description: The e-mail of the person to contact regarding this API
        team:
          title: Team
          type: string
          description: The team/division responsible for this API
    - title: Domain Model Definitions
      type: array
      items:
        title: Domain Model
        type: object
        required:
          - domainModelName
        properties:
          domainModelName:
            title: Domain Model Name
            type: string
          domainModelProperties:
            title: Properties
            type: array
            items:
              type: object
              required:
                - propertyName
                - propertyValue
              properties:
                propertyName:
                  title: Property Name
                  type: string
                  description: The name of the property
                propertyValue:
                  title: Property Value Type
                  type: string
                  description: The type of this property's value
                  enum: [ "string","integer","number","boolean","domain model" ]
                listFlag:
                  type: boolean
                  title: Property contains array of values
              allOf:
                - if:
                    properties:
                      propertyValue:
                        const: "domain model"
                  then:
                    properties:
                      searchModel:
                        title: Find Domain Model
                        type: string
                    required:
                      - searchModel
    - title: Operation Definitions
      type: array
      items:
        title: Controller
        type: object
        required:
          - controllerName
          - controllerDescription
        properties:
          controllerName:
            title: Controller Name
            type: string
          controllerDescription:
            title: Controller Description
            type: string
          operations:
            title: Operations
            type: array
            items:
              title: Operation
              type: object
              required:
                - operationDescription
                - operationType
              properties:
                operationDescription:
                  title: Operation Description
                  type: string
                operationType:
                  title: Operation Type
                  type: string
                  description: The type of this property's value
                  enum: [ "Retrieve records","Create new record","Update whole record","Update specific fields of record","Delete record" ]
    - title: Documentation
      type: object
      properties:
        documents:
          type: array
          title: Additional Documentation
          items:
            type: string
            format: data-url
        samples:
          type: array
          title: Sample requests/responses
          items:
            type: string
            format: data-url

  # These steps are executed in the scaffolder backend, using data that we gathered
  # via the parameters above.
  steps:
    - id: debug-stuff
      name: Debug
      action: debug:log
      input:
        message: Hello!
        listWorkspace: false
